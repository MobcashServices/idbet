<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>تسجيل الدخول - Idbet</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap');
  :root {
    --brand: #e50914;
  }
  * {
    margin: 0; padding: 0; box-sizing: border-box;
  }
  body {
    font-family: 'Tajawal', sans-serif;
    background: #f5f5f5;
    color: #333;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
  }
  .login-container {
    background: #fff;
    padding: 28px 24px;
    max-width: 380px;
    width: 100%;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgb(0 0 0 / 0.07);
  }
  h2 {
    font-weight: 700;
    font-size: 1.5rem;
    margin-bottom: 18px;
    text-align: center;
    color: var(--brand);
  }
  label {
    font-weight: 600;
    margin-bottom: 6px;
    display: block;
  }
  input[type="text"] {
    width: 100%;
    padding: 10px 14px;
    font-size: 1rem;
    border: 1.8px solid #ccc;
    border-radius: 10px;
    outline: none;
    transition: border-color 0.3s;
  }
  input[type="text"]:focus {
    border-color: var(--brand);
  }
  .error-msg {
    font-size: 0.85rem;
    height: 22px;
    margin-top: 6px;
    color: red;
    text-align: center;
  }
  .platform-list {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 14px;
    margin: 24px 0;
    justify-items: center;
    align-items: center;
  }
  .platform-item {
    width: 100%;
    max-width: 100px;
    height: 100px;
    cursor: pointer;
    border: 2px solid #eee;
    border-radius: 12px;
    padding: 10px;
    text-align: center;
    transition: all 0.25s ease;
    background: #fafafa;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }
  .platform-item:hover {
    border-color: var(--brand);
    box-shadow: 0 4px 12px rgba(229,9,20,0.2);
  }
  .platform-item.selected {
    border-color: var(--brand);
    box-shadow: 0 0 12px rgba(229,9,20,0.4);
    background: #fff0f0;
  }
  .platform-item img {
    max-height: 48px;
    object-fit: contain;
    margin-bottom: 8px;
    user-select: none;
  }
  .platform-name {
    font-weight: 600;
    font-size: 0.85rem;
    color: #333;
    user-select: none;
  }
  button.submit-btn {
    width: 100%;
    background: var(--brand);
    border: none;
    color: white;
    font-weight: 700;
    font-size: 1.1rem;
    padding: 12px 0;
    border-radius: 12px;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    transition: background-color 0.3s ease;
  }
  button.submit-btn:disabled {
    background: #ccc;
    cursor: not-allowed;
  }
  button.submit-btn:hover:not(:disabled) {
    background: #b20710;
  }
  .spinner {
    border: 3px solid rgba(255,255,255,0.6);
    border-top: 3px solid #fff;
    border-radius: 50%;
    width: 18px;
    height: 18px;
    animation: spin 0.8s linear infinite;
  }
  @keyframes spin {
    to { transform: rotate(360deg); }
  }
  .msg-box {
    margin-top: 12px;
    font-size: 0.9rem;
    min-height: 24px;
    text-align: center;
  }
  .msg-error {
    color: red;
  }
  .msg-success {
    color: green;
  }
</style>
</head>
<body>

<div class="login-container">
  <h2>تسجيل الدخول</h2>
  
  <label for="userId">أدخل معرف اللاعب (ID - 10 أرقام)</label>
  <input type="text" id="userId" maxlength="10" placeholder="مثال: 1234567890" />

  <div class="error-msg" id="idError"></div>

  <div class="platform-list" id="platformList">
    <div class="platform-item" data-name="Mega pari">
      <img src="https://i.postimg.cc/3RRJsCtS/Wh7-Gu-Bom34-Xq4-Bu-QN5n-Qlj-XPXf-V6-CZothm-Lsl6a-S.webp" alt="Mega pari" />
      <div class="platform-name">Mega pari</div>
    </div>
    <div class="platform-item" data-name="Linbet">
      <img src="https://i.postimg.cc/x1p0KbfL/cropped-linebet-logo.png" alt="Linbet" />
      <div class="platform-name">Linbet</div>
    </div>
    <div class="platform-item" data-name="Gooobet">
      <img src="https://i.postimg.cc/NMyXmrWn/c943dc665c7e8926e8fb15cadd4e1eee.jpg" alt="Gooobet" />
      <div class="platform-name">Gooobet</div>
    </div>
    <div class="platform-item" data-name="1xbet">
      <img src="https://i.postimg.cc/PrMCL4Cx/1-XBet-Casino-1200x900-1.png" alt="1xbet" />
      <div class="platform-name">1xbet</div>
    </div>
    <div class="platform-item" data-name="Melbet">
      <img src="https://i.postimg.cc/wjCr86FS/melbet.png" alt="Melbet" />
      <div class="platform-name">Melbet</div>
    </div>
  </div>

  <button class="submit-btn" id="submitBtn" disabled>
    <span class="btn-text">تسجيل الدخول</span>
    <span class="spinner" style="display:none;"></span>
  </button>

  <div class="msg-box" id="msgBox"></div>
</div>

<script>
  const userIdInput = document.getElementById('userId');
  const idError = document.getElementById('idError');
  const platformList = document.getElementById('platformList');
  const submitBtn = document.getElementById('submitBtn');
  const msgBox = document.getElementById('msgBox');
  const btnText = submitBtn.querySelector('.btn-text');
  const spinner = submitBtn.querySelector('.spinner');

  let selectedPlatform = null;

  userIdInput.addEventListener('input', () => {
    userIdInput.value = userIdInput.value.replace(/\D/g, '');
    validateForm();
  });

  platformList.querySelectorAll('.platform-item').forEach(item => {
    item.addEventListener('click', () => {
      selectedPlatform = item.dataset.name;
      platformList.querySelectorAll('.platform-item').forEach(el => el.classList.remove('selected'));
      item.classList.add('selected');
      validateForm();
    });
  });

  function isRepeatedDigits(id) {
    return /^(\d)\1{9}$/.test(id);
  }

  function validateForm() {
    const idVal = userIdInput.value;
    idError.textContent = '';
    msgBox.textContent = '';

    if (idVal.length !== 10) {
      idError.textContent = 'يجب أن يحتوي الـ ID على 10 أرقام.';
      submitBtn.disabled = true;
      return;
    }
    if (isRepeatedDigits(idVal)) {
      idError.textContent = 'الـ ID غير صالح (أرقام متكررة).';
      submitBtn.disabled = true;
      return;
    }
    if (!selectedPlatform) {
      submitBtn.disabled = true;
      return;
    }
    submitBtn.disabled = false;
  }

  submitBtn.addEventListener('click', async () => {
    submitBtn.disabled = true;
    btnText.style.display = 'none';
    spinner.style.display = 'inline-block';
    idError.textContent = '';
    msgBox.textContent = '';

    const payload = {
      userId: userIdInput.value,
      platform: selectedPlatform
    };

    try {
      const response = await fetch('https://script.google.com/macros/s/AKfycbzQXqfYK3rzSSR-ZKYDxsa1iqTQUpfflHnDZQVnU3hKxNoLG0j3gPO0KIijH5YZelQg3A/exec', {
        method: 'POST',
        mode: 'no-cors',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(payload)
      });

      msgBox.textContent = 'تم الإرسال بنجاح! سيتم تحويلك قريباً...';
      msgBox.className = 'msg-box msg-success';

      setTimeout(() => {
        window.location.href = 'home.html';
      }, 900);

    } catch (error) {
      msgBox.textContent = 'فشل في الإرسال. حاول مرة أخرى.';
      msgBox.className = 'msg-box msg-error';
      submitBtn.disabled = false;
      btnText.style.display = 'inline';
      spinner.style.display = 'none';
    }
  });

  validateForm();
</script>

</body>
</html>
